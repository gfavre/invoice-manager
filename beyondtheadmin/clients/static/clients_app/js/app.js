(function(){var e={7480:function(e,t,n){"use strict";n.r(t),t["default"]={"Client for":e=>{const{normalize:t}=e;return t(["Kunde für"])},"Type of client":e=>{const{normalize:t}=e;return t(["Kundentyp"])},Company:e=>{const{normalize:t}=e;return t(["Firma"])},Person:e=>{const{normalize:t}=e;return t(["Person"])},Invoices:e=>{const{normalize:t}=e;return t(["Rechnungen"])},"First name":e=>{const{normalize:t}=e;return t(["Vorname"])},"Last name":e=>{const{normalize:t}=e;return t(["Nachname"])},Address:e=>{const{normalize:t}=e;return t(["Adresse"])},Country:e=>{const{normalize:t}=e;return t(["Land"])},City:e=>{const{normalize:t}=e;return t(["Stadt"])},"Postal code":e=>{const{normalize:t}=e;return t(["Postleitzahl"])},"Search on company register":e=>{const{normalize:t}=e;return t(["Suche im Firmenregister"])},"Company name":e=>{const{normalize:t}=e;return t(["Firmenname"])},"Contact's first name":e=>{const{normalize:t}=e;return t(["Vorname des Ansprechpartners"])},"Contact's last name":e=>{const{normalize:t}=e;return t(["Nachname des Ansprechpartners"])},"Contact's email":e=>{const{normalize:t}=e;return t(["E-Mail-Adresse des Ansprechpartners"])},Currency:e=>{const{normalize:t}=e;return t(["Währung"])},"VAT rate":e=>{const{normalize:t}=e;return t(["Mehrwertsteuersatz"])},"Default hourly rate":e=>{const{normalize:t}=e;return t(["Standard-Stundensatz"])},Language:e=>{const{normalize:t}=e;return t(["Sprache"])},"Payment delay":e=>{const{normalize:t}=e;return t(["Zahlungsfrist"])},"Default delay in days to due date":e=>{const{normalize:t}=e;return t(["Standardzahlungsfrist in Tagen"])},"Next invoice code":e=>{const{normalize:t}=e;return t(["Nächster Rechnungscode"])},Slug:e=>{const{normalize:t}=e;return t(["Kunden-Code"])},"Used to generate invoice code":e=>{const{normalize:t}=e;return t(["Zur Generierung des Rechnungscodes verwendet"])},"Current count of invoices":e=>{const{normalize:t}=e;return t(["Aktuelle Anzahl von Rechnungen"])},English:e=>{const{normalize:t}=e;return t(["Englisch"])},French:e=>{const{normalize:t}=e;return t(["Französisch"])},German:e=>{const{normalize:t}=e;return t(["Deutsch"])},Italian:e=>{const{normalize:t}=e;return t(["Italienisch"])},"Default VAT rate for {company} is {vatRate}%":e=>{const{normalize:t,interpolate:n,named:a}=e;return t(["Standard-Mehrwertsteuersatz für ",n(a("company"))," ist ",n(a("vatRate")),"%"])}}},3482:function(e,t,n){"use strict";n.r(t),t["default"]={"Client for":e=>{const{normalize:t}=e;return t(["Client for"])},"Type of client":e=>{const{normalize:t}=e;return t(["Type of client"])},Company:e=>{const{normalize:t}=e;return t(["Company"])},Person:e=>{const{normalize:t}=e;return t(["Person"])},Invoices:e=>{const{normalize:t}=e;return t(["Invoices"])},"Search on company register":e=>{const{normalize:t}=e;return t(["Search on company register"])},"Company name":e=>{const{normalize:t}=e;return t(["Company name"])},Address:e=>{const{normalize:t}=e;return t(["Address"])},City:e=>{const{normalize:t}=e;return t(["City"])},"Postal code":e=>{const{normalize:t}=e;return t(["Postal code"])},Country:e=>{const{normalize:t}=e;return t(["Country"])},"Contact's first name":e=>{const{normalize:t}=e;return t(["Contact's first name"])},"Contact's last name":e=>{const{normalize:t}=e;return t(["Contact's last name"])},"Contact's email":e=>{const{normalize:t}=e;return t(["Contact's email"])},Currency:e=>{const{normalize:t}=e;return t(["Currency"])},"VAT rate":e=>{const{normalize:t}=e;return t(["VAT rate"])},"Default hourly rate":e=>{const{normalize:t}=e;return t(["Default hourly rate"])},Language:e=>{const{normalize:t}=e;return t(["Language"])},English:e=>{const{normalize:t}=e;return t(["English"])},German:e=>{const{normalize:t}=e;return t(["German"])},French:e=>{const{normalize:t}=e;return t(["French"])},Italian:e=>{const{normalize:t}=e;return t(["Italian"])},"Payment delay":e=>{const{normalize:t}=e;return t(["Payment delay"])},"Default delay in days to due date":e=>{const{normalize:t}=e;return t(["Default delay in days to due date"])},"Next invoice code":e=>{const{normalize:t}=e;return t(["Next invoice code"])},Slug:e=>{const{normalize:t}=e;return t(["Slug"])},"Used to generate invoice code":e=>{const{normalize:t}=e;return t(["Used to generate invoice code"])},"Current count of invoices":e=>{const{normalize:t}=e;return t(["Current count of invoices"])},"First name":e=>{const{normalize:t}=e;return t(["First name"])},"Last name":e=>{const{normalize:t}=e;return t(["Last name"])},"Default VAT rate for {company} is {vatRate}%":e=>{const{normalize:t,interpolate:n,named:a}=e;return t(["Default VAT rate for ",n(a("company"))," is ",n(a("vatRate")),"%"])}}},5627:function(e,t,n){"use strict";n.r(t),t["default"]={"Client for":e=>{const{normalize:t}=e;return t(["Client pour"])},"Type of client":e=>{const{normalize:t}=e;return t(["Type de client"])},Company:e=>{const{normalize:t}=e;return t(["Entreprise"])},Person:e=>{const{normalize:t}=e;return t(["Personne"])},Invoices:e=>{const{normalize:t}=e;return t(["Factures"])},"First name":e=>{const{normalize:t}=e;return t(["Prénom"])},"Last name":e=>{const{normalize:t}=e;return t(["Nom"])},Address:e=>{const{normalize:t}=e;return t(["Adresse"])},Country:e=>{const{normalize:t}=e;return t(["Pays"])},City:e=>{const{normalize:t}=e;return t(["Localité"])},"Postal code":e=>{const{normalize:t}=e;return t(["Code postal"])},"Search on company register":e=>{const{normalize:t}=e;return t(["Rechercher dans le registre du commerce"])},"Company name":e=>{const{normalize:t}=e;return t(["Nom de l'entreprise"])},"Contact's first name":e=>{const{normalize:t}=e;return t(["Prénom du contact"])},"Contact's last name":e=>{const{normalize:t}=e;return t(["Nom du contact"])},"Contact's email":e=>{const{normalize:t}=e;return t(["Email du contact"])},Currency:e=>{const{normalize:t}=e;return t(["Devise"])},"VAT rate":e=>{const{normalize:t}=e;return t(["Taux de TVA"])},"Default hourly rate":e=>{const{normalize:t}=e;return t(["Tarif horaire par défaut"])},Language:e=>{const{normalize:t}=e;return t(["Langue"])},"Payment delay":e=>{const{normalize:t}=e;return t(["Délai de paiement"])},"Default delay in days to due date":e=>{const{normalize:t}=e;return t(["Délai par défaut en jours pour la date d'échéance"])},"Next invoice code":e=>{const{normalize:t}=e;return t(["Code de la prochaine facture"])},Slug:e=>{const{normalize:t}=e;return t(["Code client"])},"Used to generate invoice code":e=>{const{normalize:t}=e;return t(["Utilisé pour générer le code de la facture"])},"Current count of invoices":e=>{const{normalize:t}=e;return t(["Décompte actuel de factures"])},English:e=>{const{normalize:t}=e;return t(["Anglais"])},French:e=>{const{normalize:t}=e;return t(["Français"])},German:e=>{const{normalize:t}=e;return t(["Allemand"])},Italian:e=>{const{normalize:t}=e;return t(["Italien"])},"Default VAT rate for {company} is {vatRate}%":e=>{const{normalize:t,interpolate:n,named:a}=e;return t(["Le taux de TVA par défaut pour ",n(a("company"))," est ",n(a("vatRate")),"%"])}}},9619:function(e,t,n){"use strict";var a=n(9242),o=n(3396),r=n(7139);const i={key:0,id:"div_id_company",class:"form-group"},s={for:"id_company_0",class:"requiredField"},l=(0,o._)("span",{class:"asteriskField"},"*",-1),c=["value","id"],d=["for"],u=(0,o._)("hr",null,null,-1),m={id:"div_id_client_type",class:"form-group"},p={for:"id_client_type_0",class:"requiredField"},h=(0,o._)("span",{class:"asteriskField"},"*",-1),y={class:"custom-control custom-radio custom-control-inline"},_={class:"custom-control-label",for:"id_client_type_0"},f=(0,o._)("i",{class:"bi bi-buildings"},null,-1),v={class:"custom-control custom-radio custom-control-inline"},g={class:"custom-control-label",for:"id_client_type_1"},C=(0,o._)("i",{class:"bi bi-person-fill"},null,-1),z={class:"border-left-info shadow",id:"company_infos"},w={class:"mb-1"},b={class:"border-left-primary shadow",id:"company_infos"},U={class:"mb-1"},F={class:"border-left-success shadow"},x={class:"mb-1"},k={class:"buttonHolder"};function $(e,t,n,$,D,V){const S=(0,o.up)("person-form"),N=(0,o.up)("company-form"),R=(0,o.up)("InvoiceForm");return(0,o.wg)(),(0,o.iD)(o.HY,null,[D.companies.length>1?((0,o.wg)(),(0,o.iD)("div",i,[(0,o._)("label",s,[(0,o.Uk)((0,r.zw)(e.$t("Client for")),1),l]),(0,o._)("div",null,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(D.companies,(e=>((0,o.wg)(),(0,o.iD)("div",{class:"custom-control custom-radio custom-control-inline",key:e.id},[(0,o.wy)((0,o._)("input",{type:"radio",class:"custom-control-input",name:"company",required:"",value:e.id,id:"company-"+e.id,"onUpdate:modelValue":t[0]||(t[0]=e=>D.company=e)},null,8,c),[[a.G2,D.company]]),(0,o._)("label",{class:"custom-control-label",for:"company-"+e.id},(0,r.zw)(e.name),9,d)])))),128))]),u])):(0,o.kq)("",!0),(0,o._)("div",m,[(0,o._)("label",p,[(0,o.Uk)((0,r.zw)(e.$t("Type of client")),1),h]),(0,o._)("div",null,[(0,o._)("div",y,[(0,o.wy)((0,o._)("input",{type:"radio",class:"custom-control-input",name:"client_type",value:"company",id:"id_client_type_0",required:"","onUpdate:modelValue":t[1]||(t[1]=e=>D.clientType=e)},null,512),[[a.G2,D.clientType]]),(0,o._)("label",_,[f,(0,o.Uk)(" "+(0,r.zw)(e.$t("Company")),1)])]),(0,o._)("div",v,[(0,o.wy)((0,o._)("input",{type:"radio",class:"custom-control-input",name:"client_type",value:"person",id:"id_client_type_1",required:"","onUpdate:modelValue":t[2]||(t[2]=e=>D.clientType=e)},null,512),[[a.G2,D.clientType]]),(0,o._)("label",g,[C,(0,o.Uk)(" "+(0,r.zw)(e.$t("Person")),1)])])])]),(0,o.wy)((0,o._)("section",null,[(0,o._)("fieldset",z,[(0,o._)("legend",w,(0,r.zw)(e.$t("Person")),1),(0,o.Wm)(S,{ref:"personForm",onSaved:V.handleComponentSaved,"onUpdate:lastName":V.slugUpdate},null,8,["onSaved","onUpdate:lastName"])])],512),[[a.F8,V.isPerson]]),(0,o.wy)((0,o._)("section",null,[(0,o._)("fieldset",b,[(0,o._)("legend",U,(0,r.zw)(e.$t("Company")),1),(0,o.Wm)(N,{ref:"companyForm",onSaved:V.handleComponentSaved,"onUpdate:name":V.slugUpdate},null,8,["onSaved","onUpdate:name"])])],512),[[a.F8,V.isCompany]]),(0,o._)("section",null,[(0,o._)("fieldset",F,[(0,o._)("legend",x,(0,r.zw)(e.$t("Invoices")),1),(0,o.Wm)(R,{ref:"invoiceForm",onSaved:V.handleComponentSaved,company:D.selectedCompany,"default-language":D.defaultLanguage,"default-vat-rate":D.vatRate,"is-vat-enabled":D.vatEnabled,"updated-slug":D.slug},null,8,["onSaved","company","default-language","default-vat-rate","is-vat-enabled","updated-slug"])])]),(0,o._)("div",k,[(0,o._)("input",{type:"submit",name:"submit",value:"Enregistrer",class:(0,r.C_)(["btn btn-primary button white",{disabled:!V.isFormComplete}]),id:"submit-id-submit",onClick:t[3]||(t[3]=(0,a.iM)((e=>V.isFormComplete?V.saveClient():V.focusFirstError()),["prevent"]))},null,2)])],64)}const D={class:"form-row"},V={class:"col-md"},S={class:"form-group"},N={for:"id_first_name",class:"requiredField"},R=(0,o._)("span",{class:"asteriskField"},"*",-1),T={class:"col-md"},L={class:"form-group"},E={for:"id_last_name",class:"requiredField"},I=(0,o._)("span",{class:"asteriskField"},"*",-1),P={class:"form-group"},A={for:"id_address"},q={class:"form-row"},Z={class:"form-group"},H=(0,o._)("label",{for:"id_country"},"Pays",-1),O={class:"form-group"},W=(0,o._)("label",{for:"id__email"},"E-mail",-1),j={class:"invalid-feedback"};function M(e,t,n,i,s,l){const c=(0,o.up)("city-auto-complete"),d=(0,o.up)("country-select");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o._)("div",D,[(0,o._)("div",V,[(0,o._)("div",S,[(0,o._)("label",N,[(0,o.Uk)((0,r.zw)(e.$t("First name"))+" ",1),R]),(0,o.wy)((0,o._)("input",{type:"text",name:"first_name",maxlength:"255",class:"textinput textInput form-control",id:"id_first_name","onUpdate:modelValue":t[0]||(t[0]=e=>s.firstName=e),ref:"FirstName",required:"required"},null,512),[[a.nr,s.firstName]])])]),(0,o._)("div",T,[(0,o._)("div",L,[(0,o._)("label",E,[(0,o.Uk)((0,r.zw)(e.$t("Last name"))+" ",1),I]),(0,o.wy)((0,o._)("input",{type:"text",name:"contact_last_name",maxlength:"255",required:"required",class:"textinput textInput form-control",id:"id_last_name","onUpdate:modelValue":t[1]||(t[1]=e=>s.lastName=e),onBlur:t[2]||(t[2]=e=>l.nameChanged())},null,544),[[a.nr,s.lastName]])])])]),(0,o._)("div",P,[(0,o._)("label",A,(0,r.zw)(e.$t("Address")),1),(0,o.wy)((0,o._)("textarea",{name:"address",cols:"40",rows:"2",class:"textarea form-control",id:"id_address","onUpdate:modelValue":t[3]||(t[3]=e=>s.address=e)},null,512),[[a.nr,s.address]])]),(0,o._)("div",q,[(0,o.Wm)(c,{city:s.city,"onUpdate:city":t[4]||(t[4]=e=>s.city=e),zipcode:s.zipCode,"onUpdate:zipcode":t[5]||(t[5]=e=>s.zipCode=e),"city-label":e.$t("City"),"zipcode-label":e.$t("Postal code")},null,8,["city","zipcode","city-label","zipcode-label"])]),(0,o._)("div",Z,[H,(0,o.Wm)(d,{modelValue:s.country,"onUpdate:modelValue":t[6]||(t[6]=e=>s.country=e),country:s.country,topCountry:"CH",autocomplete:!0,"class-name":"form-control"},null,8,["modelValue","country"])]),(0,o._)("div",O,[W,(0,o.wy)((0,o._)("input",{type:"email",name:"email",maxlength:"254",class:(0,r.C_)(["emailinput form-control",{"is-invalid":l.emailError}]),id:"id_email","onUpdate:modelValue":t[7]||(t[7]=e=>s.email=e)},null,2),[[a.nr,s.email]]),(0,o._)("div",j,(0,r.zw)(l.emailErrorMessage),1)])],64)}const G={class:"col-md-3"},Y={id:"div_id_zip_code",class:"form-group"},K={for:"id_zip_code"},B={class:"input-group"},Q=["onClick"],X={class:"col-md-9"},J={id:"div_id_city",class:"form-group"},ee={for:"id_city"};function te(e,t,n,i,s,l){return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o._)("div",G,[(0,o._)("div",Y,[(0,o._)("label",K,(0,r.zw)(n.zipcodeLabel),1),(0,o._)("div",B,[(0,o.wy)((0,o._)("input",{type:"text",name:"zip_code",maxlength:"10",class:"textinput textInput form-control",id:"id_zip_code",onInput:t[0]||(t[0]=(...e)=>l.onZipcodeInput&&l.onZipcodeInput(...e)),"onUpdate:modelValue":t[1]||(t[1]=e=>s.localZipcode=e)},null,544),[[a.nr,s.localZipcode]]),(0,o._)("ul",{class:(0,r.C_)(["dropdown-menu shadow",{show:l.isCitiesDropdownVisible}]),ref:"dropdown"},[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(s.cities,(e=>((0,o.wg)(),(0,o.iD)("li",{key:e},[(0,o._)("a",{class:"dropdown-item",onClick:t=>l.onCitySelected(e)},(0,r.zw)(e),9,Q)])))),128))],2)])])]),(0,o._)("div",X,[(0,o._)("div",J,[(0,o._)("label",ee,(0,r.zw)(n.cityLabel),1),(0,o.wy)((0,o._)("input",{type:"text",name:"city",maxlength:"255",class:"textinput textInput form-control",id:"id_city","onUpdate:modelValue":t[2]||(t[2]=e=>s.localCity=e)},null,512),[[a.nr,s.localCity]])])])],64)}var ne=n(6321),ae={name:"CityAutoComplete.vue",props:{zipcode:String,city:String,zipcodeLabel:{type:String,required:!0},cityLabel:{type:String,required:!0}},computed:{isCitiesDropdownVisible(){return this.cities.length>0}},data(){return{localCity:this.city,localZipcode:this.zipcode,cities:[]}},methods:{onCitySelected(e){this.localCity=e,this.cities=[]},onZipcodeInput(){""===this.localCity&&(this.localZipcode.length<3||(this.cities=(0,ne.cityFromZip)(this.localZipcode),1===this.cities.length&&(this.localCity=this.cities[0],this.cities=[])))},onWindowClick(e){this.$refs.dropdown&&!this.$refs.dropdown.contains(e.target)&&(this.cities=[])}},watch:{localCity(e){this.$emit("update:city",e)},localZipcode(e){this.$emit("update:zipcode",e)},city(e){this.localCity=e},zipcode(e){this.localZipcode=e}},mounted(){window.addEventListener("click",this.onWindowClick)},beforeUnmount(){window.removeEventListener("click",this.onWindowClick)}},oe=n(89);const re=(0,oe.Z)(ae,[["render",te]]);var ie=re,se=n(4255),le=n(5658),ce={name:"PersonForm",components:{CountrySelect:se.CountrySelect,CityAutoComplete:ie},data(){return{client:{},firstName:"",lastName:"",address:"",country:"",city:"",zipCode:"",email:"",errors:{}}},computed:{emailError(){return!!this.errors.contact_email},emailErrorMessage(){return this.errors.contact_email?this.errors.contact_email[0]:""}},methods:{isFormComplete(){return this.firstName.length>0&&this.lastName.length>0},nameChanged(){this.$emit("update:lastName",this.lastName)},setClient(e){this.client=e,this.firstName=e.contact_first_name,this.lastName=e.contact_last_name,this.address=e.address,this.country=e.country,this.city=e.city,this.zipCode=e.zip_code,this.email=e.contact_email},save(e){this.errors={},this.$http.patch(e,{contact_first_name:this.firstName,contact_last_name:this.lastName,contact_email:this.email,address:this.address,city:this.city,zip_code:this.zipCode,country:this.country,client_type:"person"}).then((e=>{this.$emit("saved",e.data)})).catch((e=>{e.response&&e.response.data?this.errors=e.response.data:console.error(e)}))}},setup(){const{t:e}=(0,le.QT)();return{t:e}}};const de=(0,oe.Z)(ce,[["render",M]]);var ue=de;const me={class:"form-row"},pe={class:"col-md-6"},he=(0,o._)("hr",null,null,-1),ye={id:"div_id_company_name",class:"form-group"},_e={for:"id_company_name",class:"requiredField"},fe=(0,o._)("span",{class:"asteriskField"},"*",-1),ve={id:"div_id_address",class:"form-group"},ge={for:"id_address"},Ce={class:"form-row"},ze={id:"div_id_country",class:"form-group"},we={for:"id_country"},be=(0,o._)("hr",null,null,-1),Ue={class:"form-row"},Fe={class:"col-md"},xe={id:"div_id_contact_first_name",class:"form-group"},ke={for:"id_contact_first_name"},$e={class:"col-md"},De={id:"div_id_contact_last_name",class:"form-group"},Ve={for:"id_contact_last_name"},Se={id:"div_id_contact_email",class:"form-group"},Ne={for:"id_contact_email"};function Re(e,t,n,i,s,l){const c=(0,o.up)("company-search"),d=(0,o.up)("city-auto-complete"),u=(0,o.up)("country-select");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o._)("div",me,[(0,o._)("div",pe,[(0,o.Wm)(c,{autocompleteUrl:"/api/companies-search/",companyDetailUrl:"/api/company-detail/",placeholder:e.$t("Search on company register"),onCallback:l.companyDetailLookupResult},null,8,["placeholder","onCallback"])])]),he,(0,o._)("div",ye,[(0,o._)("label",_e,[(0,o.Uk)((0,r.zw)(e.$t("Company name"))+" ",1),fe]),(0,o.wy)((0,o._)("input",{type:"text",name:"company_name",maxlength:"255",class:"textinput textInput form-control",id:"id_company_name",required:"","onUpdate:modelValue":t[0]||(t[0]=e=>s.name=e),onBlur:t[1]||(t[1]=(...e)=>l.nameChanged&&l.nameChanged(...e))},null,544),[[a.nr,s.name]])]),(0,o._)("div",ve,[(0,o._)("label",ge,(0,r.zw)(e.$t("Address")),1),(0,o.wy)((0,o._)("textarea",{name:"address",cols:"40",rows:"2",class:"textarea form-control",id:"id_address","onUpdate:modelValue":t[2]||(t[2]=e=>s.address=e)},null,512),[[a.nr,s.address]])]),(0,o._)("div",Ce,[(0,o.Wm)(d,{city:s.city,"onUpdate:city":t[3]||(t[3]=e=>s.city=e),zipcode:s.zipcode,"onUpdate:zipcode":t[4]||(t[4]=e=>s.zipcode=e),"city-label":e.$t("City"),"zipcode-label":e.$t("Postal code")},null,8,["city","zipcode","city-label","zipcode-label"])]),(0,o._)("div",ze,[(0,o._)("label",we,(0,r.zw)(e.$t("Country")),1),(0,o.Wm)(u,{modelValue:s.country,"onUpdate:modelValue":t[5]||(t[5]=e=>s.country=e),country:s.country,topCountry:"CH",autocomplete:!0,"class-name":"form-control"},null,8,["modelValue","country"])]),be,(0,o._)("div",Ue,[(0,o._)("div",Fe,[(0,o._)("div",xe,[(0,o._)("label",ke,(0,r.zw)(e.$t("Contact's first name")),1),(0,o.wy)((0,o._)("input",{type:"text",name:"contact_first_name",maxlength:"255",class:"textinput textInput form-control",id:"id_contact_first_name","onUpdate:modelValue":t[6]||(t[6]=e=>s.contactFirstName=e),ref:"contactFirstName"},null,512),[[a.nr,s.contactFirstName]])])]),(0,o._)("div",$e,[(0,o._)("div",De,[(0,o._)("label",Ve,(0,r.zw)(e.$t("Contact's last name")),1),(0,o.wy)((0,o._)("input",{type:"text",name:"contact_last_name",maxlength:"255",class:"textinput textInput form-control",id:"id_contact_last_name","onUpdate:modelValue":t[7]||(t[7]=e=>s.contactLastName=e)},null,512),[[a.nr,s.contactLastName]])])])]),(0,o._)("div",Se,[(0,o._)("label",Ne,(0,r.zw)(e.$t("Contact's email")),1),(0,o.wy)((0,o._)("input",{type:"email",name:"contact_email",maxlength:"254",class:"emailinput form-control",id:"id_contact_email","onUpdate:modelValue":t[8]||(t[8]=e=>s.contactEmail=e)},null,512),[[a.nr,s.contactEmail]])])],64)}const Te=e=>((0,o.dD)("data-v-5fe321b6"),e=e(),(0,o.Cn)(),e),Le={class:"input-group"},Ee=["placeholder"],Ie={class:"input-group-append"},Pe={class:"input-group-text"},Ae=Te((()=>(0,o._)("i",{class:"bi bi-search"},null,-1))),qe=["onClick"];function Ze(e,t,n,i,s,l){return(0,o.wg)(),(0,o.iD)("div",Le,[(0,o.wy)((0,o._)("input",{type:"text",class:"form-control",autocomplete:"off","onUpdate:modelValue":t[0]||(t[0]=e=>s.searchTerm=e),placeholder:n.placeholder,onInput:t[1]||(t[1]=(...e)=>l.companyLookup&&l.companyLookup(...e)),onFocus:t[2]||(t[2]=e=>s.isFocused=!0)},null,40,Ee),[[a.nr,s.searchTerm]]),(0,o._)("div",Ie,[(0,o.WI)(e.$slots,"appendText",{},(()=>[(0,o._)("span",Pe,[Ae,(0,o.Uk)(" "+(0,r.zw)(n.appendText),1)])]),!0)]),(0,o._)("div",{class:(0,r.C_)(["dropdown-menu company-results shadow",{show:l.isDropdownVisible}]),ref:"dropdown"},[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(s.data,(e=>((0,o.wg)(),(0,o.iD)("a",{class:"dropdown-item",key:e.uid,onClick:t=>l.companyDetailLookup(e.uid)},(0,r.zw)(e.name)+", "+(0,r.zw)(e.city),9,qe)))),128))],2)])}var He={name:"CompanySearch",computed:{isDropdownVisible(){return this.data.length>0}},data(){return{isFocused:!1,searchTerm:"",data:[],selectedCompany:null}},methods:{companyLookup(){this.searchTerm.length<3||this.$http.get(this.autocompleteUrl,{params:{q:this.searchTerm}}).then((e=>{this.data=e.data})).catch((e=>{console.log(e)}))},companyDetailLookup(e){this.$http.get(this.companyDetailUrl,{params:{uid:e}}).then((e=>{this.selectedCompany=e.data,this.onCallback(this.selectedCompany)})).catch((e=>{console.error(e)})),this.isFocused=!1,this.searchTerm="",this.data=[]},onWindowClick(e){this.$refs.dropdown&&!this.$refs.dropdown.contains(e.target)&&(this.data=[])}},props:{appendText:String,autocompleteUrl:URL,companyDetailUrl:URL,onCallback:{type:Function,required:!0},placeholder:String},mounted(){window.addEventListener("click",this.onWindowClick)},beforeUnmount(){window.removeEventListener("click",this.onWindowClick)}};const Oe=(0,oe.Z)(He,[["render",Ze],["__scopeId","data-v-5fe321b6"]]);var We=Oe,je={name:"CompanyForm",components:{CompanySearch:We,CountrySelect:se.CountrySelect,CityAutoComplete:ie},data(){return{name:"",address:"",country:"CH",zipcode:"",cities:[],city:"",contactFirstName:"",contactLastName:"",contactEmail:""}},methods:{companyDetailLookupResult(e){this.name=e.name,this.address=e.address,this.country=e.country,this.city=e.city,this.zipcode=e.zip_code,this.nameChanged(),this.$refs.contactFirstName.focus()},isFormComplete(){return this.name.length>0},save(e){this.$http.patch(e,{company_name:this.name,address:this.address,country:this.country,city:this.city,zip_code:this.zipcode,contact_first_name:this.contactFirstName,contact_last_name:this.contactLastName,contact_email:this.contactEmail,client_type:"company"}).then((e=>{this.$emit("saved",e.data)})).catch((e=>{console.error(e)}))},setClient(e){this.name=e.company_name,this.address=e.address,this.country=e.country,this.city=e.city,this.zipcode=e.zip_code,this.contactFirstName=e.contact_first_name,this.contactLastName=e.contact_last_name,this.contactEmail=e.contact_email},onWindowClick(e){this.$refs.dropdown&&!this.$refs.dropdown.contains(e.target)&&(this.cities=[])},nameChanged(){this.$emit("update:name",this.name)}},setup(){const{t:e}=(0,le.QT)();return{t:e}}};const Me=(0,oe.Z)(je,[["render",Re]]);var Ge=Me;const Ye={class:"form-row"},Ke={class:"col-md"},Be={id:"div_id_currency",class:"form-group"},Qe={for:"id_currency",class:"requiredField"},Xe=(0,o._)("span",{class:"asteriskField"},"*",-1),Je=["value"],et={key:0,class:"col-md"},tt={id:"div_id_vat_rate",class:"form-group"},nt={for:"id_vat_rate",class:""},at={class:"input-group"},ot=(0,o._)("div",{class:"input-group-append"},[(0,o._)("span",{class:"input-group-text"},"%")],-1),rt={key:0,class:"bi bi-exclamation-triangle"},it={class:"col-md"},st={id:"div_id_default_hourly_rate",class:"form-group"},lt={for:"id_default_hourly_rate",class:"requiredField"},ct=(0,o._)("span",{class:"asteriskField"},"*",-1),dt={class:"input-group"},ut={class:"input-group-append"},mt={class:"input-group-text"},pt={id:"div_id_language",class:"form-group"},ht={for:"id_language",class:"requiredField"},yt=(0,o._)("span",{class:"asteriskField"},"*",-1),_t={value:"en"},ft={value:"de"},vt={value:"fr"},gt={value:"it"},Ct={id:"div_id_payment_delay_days",class:"form-group"},zt={for:"id_payment_delay_days",class:"requiredField"},wt=(0,o._)("span",{class:"asteriskField"},"*",-1),bt={id:"hint_id_payment_delay_days",class:"form-text text-muted"},Ut=(0,o._)("hr",null,null,-1),Ft={class:"form-row"},xt={class:"col-md"},kt={for:"exampleInvoiceCode"},$t={key:0,class:"form-control-static text-monospace",id:"exampleInvoiceCode"},Dt={key:1},Vt={class:"col-md"},St={id:"div_id_slug",class:"form-group"},Nt={for:"id_slug",class:"requiredField"},Rt=(0,o._)("span",{class:"asteriskField"},"*",-1),Tt={id:"hint_id_slug",class:"form-text text-muted"},Lt={class:"col-md"},Et={id:"div_id_invoice_current_count",class:"form-group"},It={for:"id_invoice_current_count",class:"requiredField"},Pt=(0,o._)("span",{class:"asteriskField"},"*",-1),At={id:"hint_id_invoice_current_count",class:"form-text text-muted"};function qt(e,t,n,i,s,l){return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o._)("div",Ye,[(0,o._)("div",Ke,[(0,o._)("div",Be,[(0,o._)("label",Qe,[(0,o.Uk)((0,r.zw)(e.$t("Currency")),1),Xe]),(0,o.wy)((0,o._)("select",{name:"currency",class:"select custom-select",id:"id_currency","onUpdate:modelValue":t[0]||(t[0]=e=>s.currency=e)},[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(s.currencies,(e=>((0,o.wg)(),(0,o.iD)("option",{key:e.value,value:e.value},(0,r.zw)(e.text),9,Je)))),128))],512),[[a.bM,s.currency]])])]),n.isVatEnabled?((0,o.wg)(),(0,o.iD)("div",et,[(0,o._)("div",tt,[(0,o._)("label",nt,(0,r.zw)(e.$t("VAT rate")),1),(0,o._)("div",at,[(0,o.wy)((0,o._)("input",{type:"text",id:"id_vat_rate",class:"form-control","onUpdate:modelValue":t[1]||(t[1]=e=>s.vatRatePercent=e),onInput:t[2]||(t[2]=(...e)=>l.validateFloatValue&&l.validateFloatValue(...e))},null,544),[[a.nr,s.vatRatePercent]]),ot]),(0,o._)("small",{id:"hint_id_vat_rate",class:(0,r.C_)(["form-text",l.vatWarning?"text-warning":"text-muted"])},[l.vatWarning?((0,o.wg)(),(0,o.iD)("i",rt)):(0,o.kq)("",!0),(0,o.Uk)(" "+(0,r.zw)(e.$t("Default VAT rate for {company} is {vatRate}%",{company:n.company.name,vatRate:100*n.company.vat_rate})),1)],2)])])):(0,o.kq)("",!0),(0,o._)("div",it,[(0,o._)("div",st,[(0,o._)("label",lt,[(0,o.Uk)((0,r.zw)(e.$t("Default hourly rate")),1),ct]),(0,o._)("div",dt,[(0,o.wy)((0,o._)("input",{type:"number",name:"default_hourly_rate",step:"0.01",class:"numberinput form-control",required:"",id:"id_default_hourly_rate","onUpdate:modelValue":t[3]||(t[3]=e=>s.defaultHourlyRate=e)},null,512),[[a.nr,s.defaultHourlyRate,void 0,{number:!0}]]),(0,o._)("div",ut,[(0,o._)("span",mt,(0,r.zw)(s.currency),1)])])])])]),(0,o._)("div",pt,[(0,o._)("label",ht,[(0,o.Uk)((0,r.zw)(e.$t("Language")),1),yt]),(0,o.wy)((0,o._)("select",{name:"language",class:"select custom-select",id:"id_language","onUpdate:modelValue":t[4]||(t[4]=e=>s.language=e)},[(0,o._)("option",_t,(0,r.zw)(e.$t("English")),1),(0,o._)("option",ft,(0,r.zw)(e.$t("German")),1),(0,o._)("option",vt,(0,r.zw)(e.$t("French")),1),(0,o._)("option",gt,(0,r.zw)(e.$t("Italian")),1)],512),[[a.bM,s.language]])]),(0,o._)("div",Ct,[(0,o._)("label",zt,[(0,o.Uk)((0,r.zw)(e.$t("Payment delay")),1),wt]),(0,o.wy)((0,o._)("input",{type:"number",name:"payment_delay_days",class:"numberinput form-control",required:"",id:"id_payment_delay_days","onUpdate:modelValue":t[5]||(t[5]=e=>s.paymentDelayDays=e)},null,512),[[a.nr,s.paymentDelayDays]]),(0,o._)("small",bt,(0,r.zw)(e.$t("Default delay in days to due date")),1)]),Ut,(0,o._)("div",Ft,[(0,o._)("div",xt,[(0,o._)("label",kt,(0,r.zw)(e.$t("Next invoice code")),1),s.slug?((0,o.wg)(),(0,o.iD)("p",$t,(0,r.zw)(s.slug)+"-"+(0,r.zw)(s.invoiceCurrentCount+1),1)):((0,o.wg)(),(0,o.iD)("p",Dt,"n/a"))]),(0,o._)("div",Vt,[(0,o._)("div",St,[(0,o._)("label",Nt,[(0,o.Uk)((0,r.zw)(e.$t("Slug")),1),Rt]),(0,o.wy)((0,o._)("input",{type:"text",name:"slug",maxlength:"15",class:"textinput textInput form-control",required:"",id:"id_slug","onUpdate:modelValue":t[6]||(t[6]=e=>s.slug=e)},null,512),[[a.nr,s.slug]]),(0,o._)("small",Tt,(0,r.zw)(e.$t("Used to generate invoice code")),1)])]),(0,o._)("div",Lt,[(0,o._)("div",Et,[(0,o._)("label",It,[(0,o.Uk)((0,r.zw)(e.$t("Current count of invoices")),1),Pt]),(0,o.wy)((0,o._)("input",{type:"number",name:"invoice_current_count",class:"numberinput form-control",required:"",id:"id_invoice_current_count","onUpdate:modelValue":t[7]||(t[7]=e=>s.invoiceCurrentCount=e)},null,512),[[a.nr,s.invoiceCurrentCount]]),(0,o._)("small",At,(0,r.zw)(e.$t("Used to generate invoice code")),1)])])])],64)}var Zt=n(1658),Ht=n.n(Zt),Ot={name:"InvoiceForm.vue",data(){return{currency:"CHF",defaultHourlyRate:0,invoiceCurrentCount:0,language:"",paymentDelayDays:30,slug:"",vatRate:0,vatRatePercent:0,currencies:[{value:"CHF",text:"CHF"},{value:"EUR",text:"Euro"}]}},computed:{vatWarning(){return this.isVatEnabled&&this.company&&this.vatRate!==parseFloat(this.company.vat_rate)}},created(){!this.vatRate&&this.isVatEnabled&&(this.vatRate=this.defaultVatRate)},methods:{isFormComplete(){return this.currency&&this.validateNumberInput(this.defaultHourlyRate)&&this.language&&""!==this.paymentDelayDays&&this.slug&&this.validateNumberInput(this.vatRate)},limitSlugify(e){const t=Ht()(e,{lower:!0,remove:/[*+~.()'"!:@]/g});if(t.length>15){const e=t.indexOf("-");return e>0&&e<=15?t.slice(0,e):t.slice(0,15)}return t},setClient(e){this.currency=e.currency,this.invoiceCurrentCount=e.invoice_current_count,this.language=e.language,this.paymentDelayDays=e.payment_delay_days,this.slug=e.slug,this.vatRate=e.vat_rate,this.vatRatePercent=100*this.vatRate,this.defaultHourlyRate=e.default_hourly_rate},setDefaults(){this.isVatEnabled?this.vatRate||(this.vatRate=100*this.defaultVatRate):this.vatRatePercent=0},save(e){this.$http.patch(e,{currency:this.currency,invoice_current_count:this.invoiceCurrentCount,language:this.language,default_hourly_rate:this.defaultHourlyRate,payment_delay_days:this.paymentDelayDays,slug:this.slug,vat_rate:this.vatRate}).then((e=>{this.$emit("saved",e.data)})).catch((e=>{console.error(e)}))},validateNumberInput(e){return!isNaN(e)&&null!==e&&""!==e},validateFloatValue(){let e=this.vatRatePercent.replace(/[^0-9.]/g,"");const t=e.indexOf(".");-1!==t&&(e=e.slice(0,t+1)+e.slice(t+1).replace(/\./g,"")),this.vatRatePercent=e}},props:{company:{type:Object,required:!0},updatedSlug:{type:String,default:""},defaultLanguage:{type:String},defaultVatRate:{type:Number},isVatEnabled:{type:Boolean}},watch:{defaultLanguage:function(e){this.language||(this.language=e)},updatedSlug:function(e){this.slug=this.limitSlugify(e)},defaultVatRate:function(){this.setDefaults()},isVatEnabled:function(){this.setDefaults()},vatRatePercent:function(e){this.vatRate=e/100}}};const Wt=(0,oe.Z)(Ot,[["render",qt]]);var jt=Wt,Mt={name:"App",components:{PersonForm:ue,CompanyForm:Ge,InvoiceForm:jt},computed:{isCompany(){return"company"===this.clientType},isPerson(){return"person"===this.clientType},isFormComplete(){let e=this.isPerson?this.$refs.personForm:this.$refs.companyForm;return this.company.length>0&&e.isFormComplete()&&this.$refs.invoiceForm.isFormComplete()}},data(){return{clientType:"company",slug:"",client:null,clientId:null,companies:[],company:"",selectedCompany:{},vatRate:0,vatEnabled:!0,savedComponentCount:0,expectedComponentCount:2,defaultLanguage:"",urls:{clientCreateUrl:"",clientUpdateUrl:"",clientRedirectUrl:"",companiesUrl:""}}},methods:{handleComponentSaved(){this.savedComponentCount++,this.savedComponentCount===this.expectedComponentCount&&(window.location=this.urls.clientRedirectUrl)},focusFirstError(){const e=document.querySelectorAll("input[required]"),t=Array.from(e).filter((e=>!e.validity.valid));t.forEach((e=>{e.classList.add("is-invalid")}));const n=Array.from(e).filter((e=>e.validity.valid));n.forEach((e=>{e.classList.remove("is-invalid")})),t[0].focus()},async saveClient(){if(this.savedComponentCount=0,this.clientId)this.expectedComponentCount+=1,this.save();else try{const e={client_type:this.clientType,company:this.company},t=await this.$http.post(this.urls.clientCreateUrl,e);this.clientId=t.data.id,this.urls.clientUpdateUrl=t.data.url}catch(e){console.error(e)}null!==this.clientId&&(this.save(),this.$refs.invoiceForm.save(this.urls.clientUpdateUrl),this.isCompany?this.$refs.companyForm.save(this.urls.clientUpdateUrl):this.$refs.personForm.save(this.urls.clientUpdateUrl))},save(){const e={company:this.company};this.$http.patch(this.urls.clientUpdateUrl,e).then((()=>{this.handleComponentSaved()})).catch((e=>{console.error(e)}))},slugUpdate(e){""===this.slug&&(this.slug=e)}},mounted(){this.$i18n.locale=this.$el.parentNode.dataset.languageCode,this.defaultLanguage=this.$el.parentNode.dataset.languageCode,this.urls.clientCreateUrl=this.$el.parentNode.dataset.clientCreateUrl,this.urls.clientUpdateUrl=this.$el.parentNode.dataset.clientUpdateUrl,this.urls.clientRedirectUrl=this.$el.parentNode.dataset.clientRedirectUrl,this.urls.companiesUrl=this.$el.parentNode.dataset.companiesUrl,this.clientId=this.$el.parentNode.dataset.clientId,this.$http.get(this.urls.companiesUrl).then((e=>{this.companies=e.data.results,1===this.companies.length&&(this.company=this.companies[0].id)})).catch((e=>{console.error(e)})),this.urls.clientUpdateUrl&&this.$http.get(this.urls.clientUpdateUrl).then((e=>{this.client=e.data,this.clientType=this.client.client_type,this.company=this.client.company,this.slug=this.client.slug,this.$refs.companyForm.setClient(this.client),this.$refs.invoiceForm.setClient(this.client),this.$refs.personForm.setClient(this.client)})).catch((e=>{console.error(e)}))},watch:{company(e){this.selectedCompany=this.companies.find((t=>t.id===e)),void 0!==this.selectedCompany&&(this.vatEnabled=this.selectedCompany.enable_vat,this.vatRate=this.selectedCompany.vat_rate)}},setup(){const{t:e}=(0,le.QT)({inheritLocale:!0,useScope:"local"});return{t:e}}};const Gt=(0,oe.Z)(Mt,[["render",$]]);var Yt=Gt;function Kt(){const e=n(6406),t={};return e.keys().forEach((n=>{const a=n.match(/([A-Za-z0-9-_]+)\./i);if(a&&a.length>1){const o=a[1];t[o]=e(n).default}})),t}var Bt=(0,le.o)({legacy:!1,locale:"en",fallbackLocale:"en",messages:Kt()}),Qt=n(4161),Xt=n(5269),Jt=n.n(Xt);Qt.Z.get("/api/csrf-token/").then((e=>{const t=e.data.csrf_token;Qt.Z.defaults.headers.common["X-CSRFToken"]=t}));const en=(0,a.ri)(Yt);en.config.globalProperties.$http=Qt.Z,en.use(Bt).use(Jt()).mount("#app")},6406:function(e,t,n){var a={"./de.json":7480,"./en.json":3482,"./fr.json":5627};function o(e){var t=r(e);return n(t)}function r(e){if(!n.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}o.keys=function(){return Object.keys(a)},o.resolve=r,e.exports=o,o.id=6406}},t={};function n(a){var o=t[a];if(void 0!==o)return o.exports;var r=t[a]={id:a,loaded:!1,exports:{}};return e[a].call(r.exports,r,r.exports,n),r.loaded=!0,r.exports}n.m=e,function(){var e=[];n.O=function(t,a,o,r){if(!a){var i=1/0;for(d=0;d<e.length;d++){a=e[d][0],o=e[d][1],r=e[d][2];for(var s=!0,l=0;l<a.length;l++)(!1&r||i>=r)&&Object.keys(n.O).every((function(e){return n.O[e](a[l])}))?a.splice(l--,1):(s=!1,r<i&&(i=r));if(s){e.splice(d--,1);var c=o();void 0!==c&&(t=c)}}return t}r=r||0;for(var d=e.length;d>0&&e[d-1][2]>r;d--)e[d]=e[d-1];e[d]=[a,o,r]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var a in t)n.o(t,a)&&!n.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){n.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e}}(),function(){var e={143:0};n.O.j=function(t){return 0===e[t]};var t=function(t,a){var o,r,i=a[0],s=a[1],l=a[2],c=0;if(i.some((function(t){return 0!==e[t]}))){for(o in s)n.o(s,o)&&(n.m[o]=s[o]);if(l)var d=l(n)}for(t&&t(a);c<i.length;c++)r=i[c],n.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return n.O(d)},a=self["webpackChunkclients"]=self["webpackChunkclients"]||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))}();var a=n.O(void 0,[998],(function(){return n(9619)}));a=n.O(a)})();
//# sourceMappingURL=app.js.map
